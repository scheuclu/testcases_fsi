under Problem {
  Type   = UnsteadyAeroelastic;
  Mode   = Dimensional;
  Prec   = NonPreconditioned;
  Framework = BodyFitted;
}

under Input {
  Prefix = "./";
  GeometryPrefix = "./mesh/sower/fluid_sowered";
  Matcher = "./mesh/sower/fluid_sowered.match";
  //EmbeddedSurface = "./mesh/runmesh/fluidstructure_interface.top";
}

under Output {
  under Postpro {
    Prefix   = "results/";
    Pressure = "Pressure.bin";
    Mach     = "Mach.bin";
    Velocity = "Velocity.bin";
    Displacement = "Displacement.bin";
    LiftandDrag = "LiftandDrag.out";
    Frequency = 10000;
  }
  /*under Restart {*/
    /*Frequency = 50000;*/
    /*Prefix   = "references/";*/
  /*}*/
}

under Equations {
  Type = Euler;
  under FluidModel[0] {
    Fluid = PerfectGas;
    //PressureCutOff = 10.0;
    //DensityCutOff  = 0.001;
    under GasModel {
      SpecificHeatRatio = 1.4;
      PressureConstant  = 0.0;
    }
  }
}

under ReferenceState {
  Length = 1.0;
  Mach = 0.2;
  Reynolds = 1.0e7;
  Temperature = 273.15;
}

under Surfaces {
  under SurfaceData[8] {
    //BoundaryConditionID = 0;
    Nx = 0.0;
    Ny = 0.0;
    Nz = 1.0;
  }
}

under BoundaryConditions {
  under Inlet {
    Type    = External;
    Mach    = 0.5;
    Density = 1.225;
    Pressure = 1.0e4;
    Alpha   = 0.0;
    Beta    = 0.0;
  }
}

under Space {
  under NavierStokes {
    Flux              = Roe;
    Reconstruction    = Constant;//Linear
    AdvectiveOperator = FiniteVolume;
    Limiter           = VanAlbada;
    Gradient          = LeastSquares;
    Beta              = 0.66666666667;
    Gamma             = 1.0;
  }
  under Boundaries {
    Type = StegerWarming;
  }
}

under Time {
  Type   = Explicit;
  MaxIts = 20000; 
  CheckSolution = Off;
  CheckPressure = Off;
  CheckDensity = Off;
  under CflLaw {
    //NOTE: if the structure timestep is smaller than the fluid then the fluid uses the same as the structure
    //      if the structure timestep is larger than the fluid then the fluid does subcycling
    Cfl0 = 0.3;
    CflMax = 3.0;
  }
  under Explicit {
    Type = RungeKutta2;
  }
}

under MeshMotion {
  Type = Basic;
  Element = BallVertexSprings;
  Mode = Recursive;
  NumIncrements = 3;
  under Newton {
    MaxIts = 3;
    Eps = 0.01;
    under LinearSolver {
      Type = Cg;
      MaxIts = 5000;
      KrylovVectors = 100;
      Eps = 1e-12;
      under Preconditioner { Type = Jacobi; }
    }
  }
}


/*under EmbeddedFramework {*/
  /*Intersector = PhysBAM;*/
  /*SurrogateSurface = EmbeddedSurface;*/
  /*RiemannNormal = Fluid;*/
/*}*/

